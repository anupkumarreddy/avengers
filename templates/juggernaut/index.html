{% extends "base.html" %}
{% load static %}
{% block content %}
    <div class="m-grid__item m-grid__item--fluid m-wrapper">
        <!-- BEGIN: Subheader -->
        <div class="m-subheader ">
            <div class="d-flex align-items-center">
                <div class="mr-auto">
                    <h3 class="m-subheader__title ">
                        Dashboard
                    </h3>
                </div>
            </div>
        </div>
        <div class="m-content">
            <!--Begin::Section-->
            <div class="row">
                <div class="col-xl-8">
                    <!--begin::Portlet-->
                    <div class="m-portlet m-portlet--tab">
                        <div class="m-portlet__head">
                            <div class="m-portlet__head-caption">
                                <div class="m-portlet__head-title">
											<span class="m-portlet__head-icon m--hide">
												<i class="la la-gear"></i>
											</span>
                                    <h3 class="m-portlet__head-text">
                                        Upload trade book here
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <!--begin::Form-->
                        <form method="post" enctype="multipart/form-data" action="{% url 'juggernaut_index'  %}"
                              class="m-form m-form--fit m-form--label-align-right">
                            {% csrf_token %}
                            <div class="m-portlet__body ">
                                <div class="form-group m-form__group">
                                    <input type="file" name="myfile" class="form-control m-input m-input--air"
                                           id="exampleInputEmail1" aria-describedby="emailHelp"
                                           placeholder="">
                                </div>
                            </div>
                            <div class="m-portlet__foot m-portlet__foot--fit">
                                <div class="m-form__actions">
                                    <button type="submit" class="btn btn-accent">
                                        Extract
                                    </button>

                                </div>
                            </div>
                        </form>
                        <!--end::Form-->
                    </div>
                    <!--end::Portlet-->
                </div>
                <div class="col-md-12 col-lg-12 col-xl-4">
                    <div class="m-portlet">
                        <!--begin:: Widgets/Stats2-1 -->
                        <div class="m-widget1">
                            <div class="m-widget1__item">
                                <div class="row m-row--no-padding align-items-center">
                                    <div class="col">
                                        <h3 class="m-widget1__title">
                                            Total Profit
                                        </h3>
                                        <span class="m-widget1__desc">
											consolidated
                                        </span>
                                    </div>
                                    <div class="col m--align-right">
										<span class="m-widget1__number m--font-brand">
											{{ data.total_profit_loss|floatformat:2 }}
										</span>
                                    </div>
                                </div>
                            </div>
                            <div class="m-widget1__item">
                                <div class="row m-row--no-padding align-items-center">
                                    <div class="col">
                                        <h3 class="m-widget1__title">
                                            Total Orders
                                        </h3>
                                        <span class="m-widget1__desc">
											consolidated
										</span>
                                    </div>
                                    <div class="col m--align-right">
										<span class="m-widget1__number m--font-danger">
											{{ data.total_orders }}
										</span>
                                    </div>
                                </div>
                            </div>
                            <div class="m-widget1__item">
                                <div class="row m-row--no-padding align-items-center">
                                    <div class="col">
                                        <h3 class="m-widget1__title">
                                            Total Symbols
                                        </h3>
                                        <span class="m-widget1__desc">
                                            consolidated
										</span>
                                    </div>
                                    <div class="col m--align-right">
										<span class="m-widget1__number m--font-success">
											{{ data.total_symbols }}
										</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--end:: Widgets/Stats2-1 -->
                    </div>

                </div>
            </div>
            <div class="row">
                <div class="col-xl-12">
                    <div class="m-portlet m-portlet--mobile">
                        <div class="m-portlet__head">
                            <div class="m-portlet__head-caption">
                                <div class="m-portlet__head-title">
                                    <h3 class="m-portlet__head-text">
                                        Symbol Bar
                                    </h3>
                                </div>
                            </div>
                            <div class="m-portlet__head-tools">
                            </div>
                        </div>
                        <div class="m-portlet__body">
                            <!--begin: Search Form -->
                            <div class="m-form m-form--label-align-right m--margin-top-20 m--margin-bottom-30">
                                <div class="row align-items-center">
                                    <div class="col-xl-8 order-2 order-xl-1">
                                        <div class="form-group m-form__group row align-items-center">

                                            <div class="col-md-12">
                                                <div class="m-input-icon m-input-icon--left">
                                                    <input type="text" class="form-control m-input"
                                                           placeholder="Search..." id="generalSearch">
                                                    <span class="m-input-icon__icon m-input-icon__icon--left">
															<span>
																<i class="la la-search"></i>
															</span>
														</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <!--end: Search Form -->
                            <!--begin: Datatable -->
                            <table class="m-datatable" id="html_table" width="100%">
                                <thead>
                                <tr>
                                    <th title="Field #1">
                                        Symbol
                                    </th>
                                    <th title="Field #2">
                                        avg buy price
                                    </th>
                                    <th title="Field #3">
                                        last bought price
                                    </th>
                                    <th title="Field #4">
                                        closed units
                                    </th>
                                    <th title="Field #5">
                                        closed value
                                    </th>
                                    <th title="Field #6">
                                        open units
                                    </th>
                                    <th title="Field #7">
                                        current value
                                    </th>
                                    <th title="Field #8">
                                        avg sell price
                                    </th>
                                    <th title="Field #9">
                                        last sell price
                                    </th>
                                    <th title="Field #10">
                                        Profit and Loss
                                    </th>
                                    <th title="Field #11">
                                        PL Percent
                                    </th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for item in data.assets %}
                                    <tr>
                                        <td>
                                            {{ item.stock_name }}
                                        </td>
                                        <td>
                                            {{ item.stock_avg_bought|floatformat:2 }}
                                        </td>
                                        <td>
                                            {{ item.stock_last_buy|floatformat:2 }}
                                        </td>
                                        <td>
                                            {{ item.stock_units_closed }}
                                        </td>
                                        <td>
                                            {{ item.stock_closed_value|floatformat:2 }}
                                        </td>
                                        <td>{{item.stock_units_held}}</td>
                                        <td>
                                            {{ item.stock_current_value|floatformat:2 }}
                                        </td>
                                        <td>
                                            {{ item.stock_avg_sell|floatformat:2 }}
                                        </td>
                                        <td>
                                            {{ item.stock_last_sell|floatformat:2 }}
                                        </td>
                                        <td>
                                            {% if item.stock_profit_loss > 0 %}
                                            <p style="color: green">
                                            {{ item.stock_profit_loss|floatformat:2 }}
                                            </p>
                                            {% else %}
                                            <p style="color: red">
                                            {{ item.stock_profit_loss|floatformat:2 }}
                                            </p>
                                            {% endif %}
                                        </td>
                                        <td>
                                            {% if item.stock_pl_percent > 0 %}
                                            <p style="color: green">
														{{ item.stock_pl_percent|floatformat:2 }}
                                            </p>
                                            {% else %}
                                            <p style="color: red">
														{{ item.stock_pl_percent|floatformat:2 }}
                                            </p>

                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            <!--end: Datatable -->
                        </div>
                    </div>
                </div>
            </div>
            <!--End::Section-->
        </div>
    </div>
{% endblock %}
{% block script_content %}
    <script src="{% static "assets/demo/default/custom/crud/metronic-datatable/base/html-table.js" %}"
            type="text/javascript"></script>
{% endblock script_content %}